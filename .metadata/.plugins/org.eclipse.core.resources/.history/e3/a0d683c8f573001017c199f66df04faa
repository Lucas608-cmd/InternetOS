package cn.org.act.internetos.signal;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.io.InputStream;
import java.io.OutputStream;
import java.util.List;

import cn.org.act.tools.StreamHelper;

public class SyncSignal extends Signal{

	@Override
	public void sendTo(List<SignalListener> listeners, OutputStream result) throws IOException {

		for(SignalListener listener:listeners){
			//TODO combine with frames
			listener.accept(this, result);
		}
	}
	
	/**
	 * AsyncSignal has to store the inputstream as it may expire
	 */
	@Override
	public void setData(InputStream stream) throws IOException{
		
		ByteArrayOutputStream bout = new ByteArrayOutputStream();
		StreamHelper.copyStream(stream, bout);
		super.setData(new ByteArrayInputStream(bout.toByteArray()));
	}
}
